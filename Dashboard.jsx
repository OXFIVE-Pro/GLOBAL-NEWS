import React, { useMemo, useState, useEffect } from 'react'
import { LineChart, Line, XAxis, YAxis, Tooltip, ResponsiveContainer, BarChart, Bar } from 'recharts'
function useAudienceData(){const [data,setData]=useState([]);useEffect(()=>{const arr=Array.from({length:24}).map((_,i)=>({time:`${i}:00`,viewers:Math.floor(200+Math.random()*1200)}));setData(arr)},[]);return data}
export default function Dashboard(){const data=useAudienceData();const peak=useMemo(()=>data.reduce((m,d)=> d.viewers>m?d.viewers:m,0),[data]);const [alerts,setAlerts]=useState([]);useEffect(()=>{if(peak>1200)setAlerts([{id:1,level:'critical',message:`Pico de audiência: ${peak} espectadores`}])},[peak]);return (<div style={{background:'linear-gradient(180deg,#041022,#08182c)',borderRadius:8,padding:12,height:'100%'}}><h3>Controle de Audiências</h3><div style={{height:180}}><ResponsiveContainer width='100%' height='100%'><LineChart data={data}><XAxis dataKey='time'/><YAxis/><Tooltip/><Line type='monotone' dataKey='viewers' stroke='#82ca9d' strokeWidth={2}/></LineChart></ResponsiveContainer></div><div style={{height:120,marginTop:12}}><ResponsiveContainer width='100%' height='100%'><BarChart data={data}><XAxis dataKey='time'/><YAxis/><Tooltip/><Bar dataKey='viewers' /></BarChart></ResponsiveContainer></div><div style={{marginTop:8}}><strong>Pico atual:</strong> {peak} espectadores</div><div style={{marginTop:8}}><strong>Alertas:</strong><ul>{alerts.length===0 ? <li>Nenhum alerta</li> : alerts.map(a=><li key={a.id}>{a.level} — {a.message}</li>)}</ul></div></div>)}